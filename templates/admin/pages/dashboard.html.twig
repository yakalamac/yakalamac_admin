{% extends 'admin/base.html.twig' %}

{% block title %}Yönetim Paneli{% endblock %}

{% block body %}
<div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3">
	<div class="breadcrumb-title pe-3">Yönetim Paneli</div>
	<div class="ps-3">
		<nav aria-label="breadcrumb">
			<ol class="breadcrumb mb-0 p-0">
				<li class="breadcrumb-item active" aria-current="page">Anasayfa</li>
			</ol>
		</nav>
	</div>
</div>
<div class="row">
	<div class="col-xxl-8 d-flex align-items-stretch">
		<div class="card w-100 overflow-hidden rounded-4">
			<div class="card-body position-relative p-4">
				<div class="row">
					<div class="col-12 col-sm-7">
						<div class="d-flex align-items-center gap-3 mb-5">
							<img src="https://cdn.yaka.la/assets/web/yakalamac-icon.png" class="rounded-circle bg-dark p-1" width="60" height="60" alt="user">
							<div class="">
								<p class="mb-0 fw-semibold">Sizi görmek güzel,</p>
								<h4 class="fw-semibold mb-0 fs-4 mb-0">
									{{ app.user.data['firstName']|default('')|upper }}
									{{ app.user.data['lastName']|default('')|upper }}
								</h4>

								{% if 'ROLE_EDITOR_ADMIN' in app.user.roles %}
									<span class="badge bg-grd-royal">Editör</span>
								{% elseif 'ROLE_SUPER_ADMIN' in app.user.roles %}
									<span class="badge bg-grd-primary">Admin</span>
								{% endif %}
							</div>
						</div>
						<div class="d-flex align-items-center gap-5">
							<div class="">
								<h4 class="mb-1 fw-semibold d-flex align-content-center">$65.4K<i class="ti ti-arrow-up-right fs-5 lh-base text-success"></i>
								</h4>
								<p class="mb-3">Today's Sales</p>
								<div class="progress mb-0" style="height:5px;">
									<div class="progress-bar bg-grd-success" role="progressbar" style="width: 60%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
								</div>
							</div>
							<div class="vr"></div>
							<div class="">
								<h4 class="mb-1 fw-semibold d-flex align-content-center">78.4%<i class="ti ti-arrow-up-right fs-5 lh-base text-success"></i>
								</h4>
								<p class="mb-3">Growth Rate</p>
								<div class="progress mb-0" style="height:5px;">
									<div class="progress-bar bg-grd-danger" role="progressbar" style="width: 60%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-12 col-sm-5">
						<div class="welcome-back-img pt-4">
							<img src="https://cdn.yaka.la/assets/web/gallery/welcome-back-3.png" height="180" alt="">
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-xl-6 col-xxl-2 d-flex align-items-stretch">
		<div class="card w-100 rounded-4">
			<div class="card-body">
				<div class="d-flex align-items-start justify-content-between mb-1">
					<div class="">
						<h5 class="mb-0">{{ todayOperations }}</h5>
						<p class="mb-0">Bugün Yapılan İşlemler</p>
					</div>
				</div>
				<div class="chart-container2 d-flex">
					<span class="material-symbols-outlined admindash-icons"> store </span>
				</div>
				<div class="text-center">
					<p class="mb-0 font-12">{{ totalBusinesses }} Toplam İşletme</p>
				</div>
			</div>
		</div>
	</div>
	<div class="col-xl-6 col-xxl-2 d-flex align-items-stretch">
		<div class="card w-100 rounded-4">
			<div class="card-body">
				<div class="d-flex align-items-start justify-content-between mb-1">
					<div class="">
						<h5 class="mb-0">{{todayOperationsProducts}}</h5>
						<p class="mb-0">Bugün Yapılan İşlem</p>
					</div>
				</div>
				<div class="chart-container2 d-flex">
                  	<span class="material-symbols-outlined admindash-icons"> shopping_bag </span>
                </div>
				<div class="text-center">
					<p class="mb-0 font-12">
						<span class="text-success me-1">{{ totalProduct }}</span>
						Toplam ürün adedi</p>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="row">
	<div class="col-lg-12 col-xxl-12 d-flex align-items-stretch">
		<div class="card w-100 rounded-4">
			<div class="card-body">
				<div class="d-flex align-items-start justify-content-between mb-3">
					<div class="">
						<h5 class="mb-0">Son aktiviteler</h5>
						<hr>
					</div>
				</div>
				<div class="table-responsive">
					<table id="auditLogsTable" class="table align-middle">
						<thead>
							<tr>
								<th>ID</th>
								<th>Kullanıcı</th>
								<th>Entity ID</th>
								<th>Entity Type</th>
								<th>Action</th>
								<th>Değişiklikler</th>
								<th>Zaman Damgası</th>
							</tr>
						</thead>
						<tbody>{# TODO #}</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="modal fade detailModal" id="ScrollableModal" tabindex="-1" aria-labelledby="detailModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
		<div class="modal-content">
			<div class="modal-header border-bottom-0 bg-grd-primary py-2">
				<h5 class="modal-title" id="detailModalLabel">Log Detayı</h5>
				<a href="javascript:void(0);" class="primaery-menu-close" data-bs-dismiss="modal"> <i class="material-icons-outlined">close</i> </a>
			</div>
			<div class="modal-body"> </div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
			</div>
		</div>
	</div>
</div>
{% if unseenChangelogs|length > 0 %}
        <div class="modal fade" id="changelogModal" tabindex="-1" aria-labelledby="changelogModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="changelogModalLabel"> <span class="material-symbols-outlined align-middle"> notifications </span> Yeni Güncelleme Notları</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        {% for changelog in unseenChangelogs %}
                            <div class="changelog-entry mb-5">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h4 class="{% if changelog.important %}text-info{% endif %}">{{ changelog.title }}</h4>
                                    <small class="{% if changelog.important %}text-info{% endif %}">
                                        {{ changelog.createdAt|date('d.m.Y H:i', 'Europe/Istanbul') }}
                                    </small>
                                </div>
                                <div class="{% if changelog.important %}text-info{% endif %}">
                                    {{ changelog.content|raw|nl2br }}
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}

{% endblock %}

{% block javascripts %}
	<script src="{{ asset('script/admin/dashboard/index.js') }}"></script>

{{ parent() }}
{% if unseenChangelogs|length > 0 %}
	<script>
		window.Twig = {
			unseenChangeLogs: {{ unseenChangeLogs|json_encode }}
		};
	</script>
	 <script src="{{ asset('script/admin/dashboard/unseen-log.js') }}"></script>
{% endif %}
{% endblock %}