{% set roles = [
    {
        "name": "EMAIL_VERIFIED_USER_YAKALA",
        "turkish": "E-posta Doğrulanmış Kullanıcı",
        "id": "9222e21f-4553-4e48-885f-114097a8e6f5",
        "description": "User who verified only their email address but not their mobile phone number. These users cannot place orders to protect restaurants and prevent uncertain orders.",
        "turkish_desc": "Sadece e-posta adresini doğrulamış, telefon numarasını doğrulamamış kullanıcı. Bu kullanıcılar restoranları korumak ve belirsiz siparişleri önlemek için sipariş veremezler.",
        "icon": "mail"
    },
    {
        "name": "PHONE_VERIFIED_USER_YAKALA",
        "turkish": "Telefon Doğrulanmış Kullanıcı",
        "id": "00311518-1b59-476e-8b6e-1bccb4246575",
        "description": "User who verified only their mobile phone number but not email. They can place orders but may miss some campaigns. While most campaigns use both SMS and email, some are only sent via email, so they may not be aware of those campaigns.",
        "turkish_desc": "Sadece telefon numarasını doğrulamış, e-posta adresini doğrulamamış kullanıcı. Sipariş verebilirler ancak bazı kampanyaları kaçırabilirler. Kampanyaların çoğu SMS ve e-posta kullanırken, bazıları sadece e-posta ile gönderildiğinden, bu kampanyalardan haberdar olmayabilirler.",
        "icon": "smartphone"
    },
    {
        "name": "ROLE_USER",
        "turkish": "Standart Kullanıcı",
        "id": "844b000d-4497-43d6-b63a-5d50023d9728",
        "description": "–",
        "turkish_desc": "Temel kullanıcı rolü.",
        "icon": "person"
    },
    {
        "name": "UNVERIFIED_USER_YAKALA",
        "turkish": "Doğrulanmamış Kullanıcı",
        "id": "858d2597-758f-4ccd-98f0-7ccf9c0414ed",
        "description": "This is a newly registered application with an unverified phone number and email. If not verified within 30 days, their account will be deleted. Users can't recover passwords if forgotten.",
        "turkish_desc": "Telefon numarası ve e-postası doğrulanmamış yeni kayıtlı kullanıcı. 30 gün içinde doğrulanmazsa hesabı silinecektir. Kullanıcılar unutulmuş şifreleri kurtaramazlar.",
        "icon": "lock"
    },
    {
        "name": "VERIFIED_USER_YAKALA",
        "turkish": "Tam Doğrulanmış Kullanıcı",
        "id": "3af5c386-509e-4e58-93f1-45b8a3492677",
        "description": "This is the super role of users on the Yaka.la application. Users with this role can benefit from all the features that the system allows without any restrictions.",
        "turkish_desc": "Yaka.la uygulamasındaki kullanıcıların süper rolüdür. Bu role sahip kullanıcılar, sistemin izin verdiği tüm özelliklerden herhangi bir kısıtlama olmadan yararlanabilirler.",
        "icon": "person"
    }
] %}

<div class="container">
    {% if application is not defined or application is null %}
        <div class="card border-primary shadow-sm mb-4">
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col-sm-6">
                        <h5 class="fw-bold mb-0">
                            <i class="material-icons-outlined align-middle me-2">app_registration</i>
                            Yakala Uygulaması için Kayıt Ol
                        </h5>
                        <p class="text-muted mt-2 mb-0">Yakala uygulamasına kaydolarak tüm özelliklere erişim sağlayın</p>
                    </div>
                    <div class="col-sm-6 text-sm-end mt-3 mt-sm-0">
                        <button type="button" class="btn btn-success px-4 py-2">
                            <i class="material-icons-outlined align-middle me-2">person_add</i>
                            Kayıt Oluştur
                        </button>
                    </div>
                </div>
            </div>
        </div>
    {% else %}
        <div class="card border-primary shadow-sm mb-4">
            <div class="card-header bg-transparent">
                <h5 class="mb-0 fw-bold">
                    <i class="material-icons-outlined align-middle me-2">verified_user</i>
                    Yakala Yetkileri
                </h5>
                <p class="text-muted mb-0">Kullanıcı için uygun rolleri seçiniz</p>
            </div>
            <div class="card-body">
                <!-- Rol Kartları -->
                <div class="row mb-4">
                    {% for role in roles %}
                        <div class="col-md-6 col-lg-4 mb-3">
                            <div class="card h-100 shadow-sm {% if role.name in application.roles|default([]) %}border-primary{% else %}border{% endif %}">
                                <div class="card-body">
                                    <div class="form-check form-switch d-flex justify-content-end mb-2">
                                        <input class="form-check-input" type="checkbox" id="role-{{ role.id }}"
                                               value="{{ role.name }}" {% if role.name in application.roles|default([]) %}checked{% endif %}>
                                    </div>
                                    <div class="d-flex align-items-center mb-3">
                                        <div class="rounded-3 d-flex align-items-center justify-content-center me-3 {% if role.name in application.roles|default([]) %}bg-primary text-white{% else %}bg-light text-primary{% endif %}" style="width: 48px; height: 48px;">
                                            <i class="material-icons-outlined">{{ role.icon }}</i>
                                        </div>
                                        <div>
                                            <h6 class="mb-0 fw-bold text-truncate" title="{{ role.turkish }}">{{ role.turkish }}</h6>
                                            <small class="text-muted">{{ role.name }}</small>
                                        </div>
                                    </div>
                                    <p class="small mb-3 text-truncate" data-bs-toggle="tooltip" title="{{ role.turkish_desc }}">
                                        {{ role.turkish_desc }}
                                    </p>
                                    <div class="text-end">
                                        <button class="btn btn-sm btn-outline-secondary" type="button"
                                                data-bs-toggle="modal" data-bs-target="#roleInfoModal-{{ role.id }}">
                                            <i class="material-icons-outlined align-middle me-1" style="font-size: 1rem;">info</i> Detaylar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Rol Detay Modali -->
                        <div class="modal fade" id="roleInfoModal-{{ role.id }}" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title fw-bold">
                                            <i class="material-icons-outlined align-middle me-2">{{ role.icon }}</i>
                                            {{ role.turkish }}
                                        </h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="mb-3">
                                            <div class="d-flex align-items-center mb-2">
                                                <div class="badge bg-primary me-2">İngilizce Ad</div>
                                                <div class="fw-semibold">{{ role.name }}</div>
                                            </div>
                                            <div class="d-flex align-items-center mb-3">
                                                <div class="badge bg-secondary me-2">ID</div>
                                                <div class="small text-muted">{{ role.id }}</div>
                                            </div>
                                        </div>
                                        <div class="card bg-light mb-3">
                                            <div class="card-body">
                                                <h6 class="mb-2 fw-bold">Türkçe Açıklama:</h6>
                                                <p class="mb-3">{{ role.turkish_desc }}</p>
                                                <h6 class="mb-2 fw-bold">İngilizce Açıklama:</h6>
                                                <p class="mb-2">{{ role.description }}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>

                <!-- Dil Bölümü Ayırıcı -->
                <div class="d-flex align-items-center mb-4">
                    <hr class="flex-grow-1">
                    <span class="mx-3 fw-bold text-muted">Tercih Edilen Diller</span>
                    <hr class="flex-grow-1">
                </div>

                <!-- Dil Seçimi -->
                <div class="card border shadow-sm mb-4">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-light rounded-3 p-2 me-3 d-flex align-items-center justify-content-center" style="width: 48px; height: 48px;">
                                <i class="material-icons-outlined">language</i>
                            </div>
                            <h6 class="mb-0">Tercih Edilen Diller</h6>
                        </div>

                        <select class="form-select" id="multiple-select-custom-field"
                                data-placeholder="Dil seçiniz"
                                data-width="100%"
                                multiple>
                            {% set available_languages = {
                                'tr': 'Türkçe',
                                'en': 'İngilizce',
                                'ar': 'Arapça',
                                'de': 'Almanca',
                                'fr': 'Fransızca',
                                'ru': 'Rusça'
                            } %}

                            {% for lang_code, lang_name in available_languages %}
                                <option value="{{ lang_code }}"
                                        {% if lang_code in application.preferredLanguages|default([]) %}selected{% endif %}>
                                    {{ lang_name }} ({{ lang_code|upper }})
                                </option>
                            {% endfor %}
                        </select>

                        <div class="mt-3">
                            <div class="d-flex flex-wrap">
                                {% for lang in application.preferredLanguages|default(['tr']) %}
                                    <div class="badge bg-light text-dark border me-2 mb-2 p-2">
                                        {% set lang_map = {
                                            'tr': 'Türkçe',
                                            'en': 'İngilizce',
                                            'ar': 'Arapça',
                                            'de': 'Almanca',
                                            'fr': 'Fransızca',
                                            'ru': 'Rusça'
                                        } %}
                                        <i class="material-icons-outlined align-middle me-1" style="font-size: 0.875rem;">check_circle</i>
                                        {{ lang_map[lang]|default(lang) }}
                                        <span class="text-uppercase ms-1">({{ lang }})</span>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="text-end mt-4">
                    <button type="button" class="btn btn-primary px-4">
                        Değişiklikleri Kaydet
                    </button>
                </div>
            </div>
        </div>
    {% endif %}
</div>
